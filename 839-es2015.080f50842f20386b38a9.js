"use strict";(self.webpackChunktwenty_one=self.webpackChunktwenty_one||[]).push([[839],{1839:function(t,e,n){n.r(e),n.d(e,{SolitaireModule:function(){return H}});var i=n(8583),s=n(3423),a=n(2340),o=n(4762),r=n(9765),c=n(6782),l=n(4394),d=n(3815),u=n(7716),g=n(7812),h=n(9195),p=n(1095),m=n(1306);function f(t,e){if(1&t&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.qZA()),2&t){const t=e.$implicit,n=u.oxw().$implicit;u.xp6(2),u.Oqu(t.name),u.xp6(2),u.Oqu(t.value(n))}}const v=function(t,e){return{"col-lg-6":t,"col-xl-4":e}};function b(t,e){if(1&t&&(u.TgZ(0,"div",18),u.ALo(1,"keyvalue"),u.ALo(2,"keyvalue"),u.TgZ(3,"h2"),u._uU(4),u.qZA(),u.TgZ(5,"table",19),u.TgZ(6,"tbody"),u.YNc(7,f,5,2,"tr",20),u.qZA(),u.qZA(),u.TgZ(8,"label"),u._uU(9,"Wins vs Losses"),u.qZA(),u.TgZ(10,"div",21),u.TgZ(11,"div",22),u.ALo(12,"percent"),u._uU(13),u.ALo(14,"percent"),u.qZA(),u.TgZ(15,"div",23),u.ALo(16,"percent"),u._uU(17),u.ALo(18,"percent"),u.qZA(),u.qZA(),u.TgZ(19,"label"),u._uU(20,"Wins : Best Winning Streak"),u.qZA(),u.TgZ(21,"div",21),u.TgZ(22,"div",24),u.ALo(23,"appPercentBar"),u.ALo(24,"percent"),u._uU(25),u.qZA(),u.qZA(),u.TgZ(26,"label"),u._uU(27,"Losses : Worst Losing Streak"),u.qZA(),u.TgZ(28,"div",21),u.TgZ(29,"div",24),u.ALo(30,"appPercentBar"),u.ALo(31,"percent"),u._uU(32),u.qZA(),u.qZA(),u.qZA()),2&t){const t=e.$implicit,n=u.oxw();u.Q6J("ngClass",u.WLB(44,v,!(null!=n.settings&&n.settings.sidebar)&&u.lcZ(1,24,n.stats).length>1,!(null!=n.settings&&n.settings.sidebar)&&u.lcZ(2,26,n.stats).length>2)),u.xp6(4),u.Oqu(t.key),u.xp6(3),u.Q6J("ngForOf",n.rows)("ngForTrackBy",n.trackByFn),u.xp6(4),u.Udp("width",t.value.totalWins+t.value.totalLosses===0?0:u.lcZ(12,28,t.value.totalWins/(t.value.totalWins+t.value.totalLosses))),u.xp6(2),u.hij(" Won: ",u.lcZ(14,30,t.value.totalWins/(t.value.totalWins+t.value.totalLosses))," "),u.xp6(2),u.Udp("width",t.value.totalWins+t.value.totalLosses===0?0:u.lcZ(16,32,t.value.totalLosses/(t.value.totalWins+t.value.totalLosses))),u.xp6(2),u.hij(" Lost: ",u.lcZ(18,34,t.value.totalLosses/(t.value.totalWins+t.value.totalLosses))," "),u.xp6(5),u.Gre("progress-bar ",0===t.value.maxWins?"bg-danger":u.lcZ(23,36,t.value.wins/t.value.maxWins),""),u.Udp("width",0===t.value.maxWins?0:u.lcZ(24,38,t.value.wins/t.value.maxWins)),u.xp6(3),u.AsE(" ",t.value.wins," : ",t.value.maxWins," "),u.xp6(4),u.Gre("progress-bar ",0===t.value.maxLose?"bg-success":u.lcZ(30,40,1-t.value.losses/t.value.maxLose),""),u.Udp("width",0===t.value.maxLose?0:u.lcZ(31,42,t.value.losses/t.value.maxLose)),u.xp6(3),u.AsE(" ",t.value.losses," : ",t.value.maxLose," ")}}const w=function(t,e){return{show:t,sidebar:e}},Z=function(t,e){return{"modal-xl":t,"modal-lg":e}},y=function(t){return{show:t}};let x=(()=>{class t{constructor(t,e,n){this.solitaire=t,this.twentyone=e,this.appRef=n,this.rows=[{name:"Total Hands Played",value:t=>`${t.value.gamesPlayed}`},{name:"Winning Streak",value:t=>`${t.value.wins||""}`},{name:"Best Winning Streak",value:t=>`${t.value.maxWins||""}`},{name:"Losiing Streak",value:t=>`${t.value.losses||""}`},{name:"Worst Losing Streak",value:t=>`${t.value.maxLose||""}`},{name:"Total Games Won",value:t=>`${t.value.totalWins}`},{name:"Total Games Lost",value:t=>`${t.value.totalLosses}`}],this.destroyed$=new r.xQ,this.trackByFn=t=>t,this.solitaire.gameStats$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.stats=t),this.twentyone.settings$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.settings=t)}ngOnInit(){setTimeout(()=>this.show=!0,0)}close(){this.show=!1,setTimeout(()=>{this.appRef.detachView(this.componentRef.hostView),this.componentRef.destroy()},180)}setSidebar(){this.settings.sidebar=!this.settings.sidebar,this.twentyone.saveSettings(this.settings)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(g.t),u.Y36(h.K),u.Y36(u.z2F))},t.\u0275cmp=u.Xpm({type:t,selectors:[["ng-component"]],inputs:{componentRef:"componentRef"},decls:26,vars:23,consts:[[1,"modal","fade",3,"ngClass","click"],[3,"ngClass","click"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["href","#",1,"tab-loop",3,"focus"],["mdAutoFocus","","type","button",1,"btn-resize",3,"click"],["first",""],["height","25px","alt","Window Resize",3,"src"],["type","button","aria-label","Close",1,"button-close",3,"click"],["src","/assets/img/close.svg","height","25px","alt","Window Resize"],[1,"modal-body"],[1,"row","d-flex","justify-content-center"],["class","col-sm-12",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"modal-footer"],["type","button","mat-stroked-button","","color","primary",3,"click"],["last",""],[1,"modal-backdrop","fade",3,"ngClass"],[1,"col-sm-12",3,"ngClass"],[1,"table","table-sm","w-100"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"progress"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-danger"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100"]],template:function(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"div",0),u.NdJ("click",function(){return e.close()}),u.TgZ(1,"div",1),u.NdJ("click",function(t){return t.stopPropagation()}),u.ALo(2,"keyvalue"),u.ALo(3,"keyvalue"),u.TgZ(4,"div",2),u.TgZ(5,"div",3),u.TgZ(6,"h5",4),u._uU(7,"Solitaire Stats"),u.qZA(),u.TgZ(8,"a",5),u.NdJ("focus",function(){return u.CHM(t),u.MAs(21).focus()}),u._uU(9,"to last"),u.qZA(),u.TgZ(10,"button",6,7),u.NdJ("click",function(){return e.setSidebar()}),u._UZ(12,"img",8),u.qZA(),u.TgZ(13,"button",9),u.NdJ("click",function(){return e.close()}),u._UZ(14,"img",10),u.qZA(),u.qZA(),u.TgZ(15,"div",11),u.TgZ(16,"div",12),u.YNc(17,b,33,47,"div",13),u.ALo(18,"keyvalue"),u.qZA(),u.qZA(),u.TgZ(19,"div",14),u.TgZ(20,"button",15,16),u.NdJ("click",function(){return e.close()}),u._uU(22," Close "),u.qZA(),u.TgZ(23,"a",5),u.NdJ("focus",function(){return u.CHM(t),u.MAs(11).focus()}),u._uU(24,"to last"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u._UZ(25,"div",17)}2&t&&(u.Q6J("ngClass",u.WLB(15,w,e.show,e.settings.sidebar)),u.xp6(1),u.Gre("modal-dialog modal-dialog-centered modal-dialog-scrollable",e.settings.sidebar?"":" modal-xl",""),u.Q6J("ngClass",u.WLB(18,Z,!e.settings.sidebar&&u.lcZ(2,9,e.stats).length>2,!e.settings.sidebar&&u.lcZ(3,11,e.stats).length>1)),u.xp6(11),u.MGl("src","/assets/img/",null!=e.settings&&e.settings.sidebar?"dice-1.svg":"arrow-right-square.svg","",u.LSH),u.xp6(5),u.Q6J("ngForOf",u.lcZ(18,13,e.stats))("ngForTrackBy",e.trackByFn),u.xp6(8),u.Q6J("ngClass",u.VKq(21,y,e.show)))},directives:[i.mk,i.sg,p.lW],pipes:[i.Nd,i.Zx,m.g],styles:["h2[_ngcontent-%COMP%]{margin:0}label[_ngcontent-%COMP%]{font-weight:600}.progress[_ngcontent-%COMP%]{margin-bottom:12px}"]}),t})();var C=n(9004),k=n(4252),T=n(3671),_=n(1026),O=n(3949);const M=["cardElement"];function P(t,e){1&t&&u._UZ(0,"app-card",6),2&t&&u.Q6J("card",e.$implicit||0)("animate",!1)}const S=function(t,e){return{"undo-drag":t,dragging:e}},A=function(t,e){return{top:t,left:e}};let q=(()=>{class t{constructor(t,e,n){this.window=t,this.solitaire=e,this.soundService=n,this.dragging=!1,this.dragged=!1,this.lastX=0,this.lastY=0,this.posX=0,this.posY=0,this.undoDrag=!1,this.tableau=[],this.foundation=[],this.cards=[],this.destroyed$=new r.xQ,this.trackByFn=(t,e)=>e,this.window.mousetouchmove$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.doDrag(t)),this.window.mousetouchend$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.endDrag(t))}start(t){t.preventDefault(),this.startElement=t.target,this.cards.length&&(document.body.classList.add("dragging"),this.dragging=!0,this.soundService.playSound("card-sound"))}doDrag(t){t.preventDefault();const e=t.clientX||d.get(t,"touches[0].clientX"),n=t.clientY||d.get(t,"touches[0].clientY"),i=void 0!==t.clientX||!t.touches[1];(Math.abs(this.posX)>10||Math.abs(this.posY)>10)&&(this.dragged=!0),this.dragging&&i&&(this.lastX&&(this.posX+=e-this.lastX,this.posY+=n-this.lastY),this.lastX=e,this.lastY=n)}endDrag(t){document.body.classList.remove("dragging");let e,n=!0;const i=d.get(t,"changedTouches[0]");if(e=i?document.elementFromPoint(i.clientX,i.clientY):document.elementFromPoint(t.x,t.y),this.dragging)if(this.dragged){let t;if(e&&(t=e.getAttribute("data-column")),t){const e=this.cards[this.cards.length-1],i=Math.floor(e/4),s=e%4;if(+t>6){if(this.foundation[+t-7].length+1===i){const e=this.foundation[+t-7][this.foundation[+t-7].length-1];if(!e||s===d.get(e,"card",e)%4){const e=this.cards.pop();this.foundation[+t-7].push(e),n=!1}}this.dragging=!1,this.dragged=!1,this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.solitaire.checkWin(this.foundation)}else{const e=this.tableau[t][this.tableau[t].length-1];let a=0,o=0;if(e&&(a=Math.floor(e.card/4),o=e.card%4),i===a-1&&s%2!=o%2||0===a&&13===i){const e=this.cards.pop();this.tableau[t].push({card:e,flip:!1}),this.tableau[t]=[...this.tableau[t]],this.solitaire.checkWin(this.foundation),n=!1}}}n&&this.resetDrag()}else this.toFoundation();this.dragging=!1,this.dragged=!1,this.posX=0,this.posY=0,this.lastX=0,this.lastY=0}resetDrag(){setTimeout(()=>this.soundService.playSound("card-sound"),180),this.undoDrag=!0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.timeout=setTimeout(()=>this.undoDrag=!1,180)},0)}toFoundation(){return(0,o.mG)(this,void 0,void 0,function*(){const t=this.cards[this.cards.length-1],e=Math.floor(t/4),n=t%4;let i=0,s=!0;for(const a of this.foundation){if(a.length+1===e){const t=a[a.length-1];if(!t||n===d.get(t,"card",t)%4){const t=document.getElementsByClassName(`foundation-${i}`)[0],{left:e,top:n}=this.startElement.getBoundingClientRect(),{left:a,top:o}=t.getBoundingClientRect(),r=e-a,c=n-o,l=this.cards.pop();this.foundation[i].push({card:l,offsetX:r,offsetY:c,deg:0,scale:1.1}),s=!1,this.solitaire.checkWin(this.foundation);break}}i++}s&&this.soundService.playSound("card-sound")})}get nativeElement(){return this.cardElement.nativeElement}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(C.u),u.Y36(g.t),u.Y36(k.y))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-card-talon"]],viewQuery:function(t,e){if(1&t&&u.Gf(M,5),2&t){let t;u.iGM(t=u.CRH())&&(e.cardElement=t.first)}},inputs:{tableau:"tableau",foundation:"foundation",cards:"cards",column:"column",animate:"animate"},decls:6,vars:12,consts:[[1,"text-center","position-relative"],["src","/assets/img/card-placeholder.png","alt","Card Placeholder","pos","relative",1,"card-placeholder"],["pos","absolute","class","card-stack",3,"card","animate",4,"ngFor","ngForOf","ngForTrackBy"],[1,"card-group","block","text-center","position-absolute","w-100",3,"ngClass","ngStyle"],["pos","relative",3,"card","animate","mousedown","touchstart"],["cardElement",""],["pos","absolute",1,"card-stack",3,"card","animate"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u._UZ(1,"img",1),u.YNc(2,P,1,2,"app-card",2),u.TgZ(3,"div",3),u.TgZ(4,"app-card",4,5),u.NdJ("mousedown",function(t){return e.start(t)})("touchstart",function(t){return e.start(t)}),u.qZA(),u.qZA(),u.qZA()),2&t&&(u.xp6(2),u.Q6J("ngForOf",e.cards.slice(0,-1))("ngForTrackBy",e.trackByFn),u.xp6(1),u.Q6J("ngClass",u.WLB(6,S,e.undoDrag,e.dragging))("ngStyle",u.WLB(9,A,e.posY+"px",e.posX+"px")),u.xp6(1),u.Q6J("card",e.cards[e.cards.length-1]||0)("animate",e.animate))},directives:[i.sg,i.mk,i.PC,O.A],styles:[".card-group[_ngcontent-%COMP%]{position:relative}.card-group[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%]{margin:0 auto;display:inline-block}.card-placeholder[_ngcontent-%COMP%]{background:rgba(0,0,0,.15);margin:4px auto}.dragging[_ngcontent-%COMP%]{pointer-events:none;touch-action:none}.undo-drag[_ngcontent-%COMP%]{transition:all .18s ease-in-out}.dragging[_ngcontent-%COMP%], .undo-drag[_ngcontent-%COMP%]{z-index:100;transform:scale(1.1);-moz-filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5));filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5))}.card-stack[_ngcontent-%COMP%]{position:absolute;width:100%;top:0;left:0}"]}),t})();var Y=n(166);const $=["card"];function F(t,e){if(1&t&&(u._UZ(0,"app-card-group",4),u.ALo(1,"cardGroup")),2&t){const t=u.oxw();u.Q6J("tableau",t.tableau)("foundation",t.foundation)("cards",u.lcZ(1,7,t.cards))("column",t.column)("width",t.width)("animate",t.animate)("cardSound",t.cardSound)}}const L=function(t,e){return{dragging:t,"undo-drag":e}},W=function(t,e){return{top:t,left:e}},X=function(t){return{select:t}},B=function(t){return{"z-index":t}};let J=(()=>{class t{constructor(t,e,n,i){this.window=t,this.solitaire=e,this.twentyone=n,this.soundService=i,this.dragging=!1,this.dragged=!1,this.lastX=0,this.lastY=0,this.posX=0,this.posY=0,this.undoDrag=!1,this.tableau=[],this.foundation=[],this.cards=[],this.destroyed$=new r.xQ,this.window.mousetouchmove$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.doDrag(t)),this.window.mousetouchend$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.endDrag(t))}start(t){t.preventDefault(),this.cards[0].flip||(this.startElement=t.target,this.dragging=!0,document.body.classList.add("dragging"),this.soundService.playSound("card-sound"))}doDrag(t){if(this.dragging){const e=t.clientX||d.get(t,"touches[0].clientX"),n=t.clientY||d.get(t,"touches[0].clientY"),i=void 0!==t.clientX||!t.touches[1];(Math.abs(this.posX)>10||Math.abs(this.posY)>10)&&(this.dragged=!0),clearTimeout(this.timeout),i&&this.lastX&&!this.cards[0].flip&&(this.posX+=e-this.lastX,this.posY+=n-this.lastY),this.lastX=e,this.lastY=n}}endDrag(t){return(0,o.mG)(this,void 0,void 0,function*(){document.body.classList.remove("dragging");let e,n=!0;const i=d.get(t,"changedTouches[0]");if(i?e=document.elementFromPoint(i.clientX,i.clientY):i||(e=document.elementFromPoint(t.clientX,t.clientY)),this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.dragging&&e){if(this.dragged){let t=null;if(e&&(t=e.getAttribute("data-column")),null!==t){t=+t;const e=this.cards[0].card,i=Math.floor(e/4),s=e%4;if(t>6){if(1===this.cards.length&&this.foundation[t-7].length+1===i){const e=this.foundation[t-7][this.foundation[t-7].length-1];if(!e||s===d.get(e,"card",e)%4){const e=this.tableau[this.column].pop();this.tableau[this.column]=[...this.tableau[this.column]],this.foundation[t-7].push(e.card),this.flipCard(),this.solitaire.checkWin(this.foundation),n=!1}}}else{const e=this.tableau[t][this.tableau[t].length-1];let a=0,o=0;if(e&&(a=Math.floor(e.card/4),o=e.card%4),i===a-1&&s%2!=o%2||0===a&&13===i){const e=this.tableau[this.column].splice(-this.cards.length);this.tableau[this.column]=[...this.tableau[this.column]],this.tableau[t].push(...e),this.tableau[t]=[...this.tableau[t]],this.flipCard(),this.solitaire.checkWin(this.foundation),n=!1}}}n&&this.resetDrag()}else this.toFoundation();this.posX=0,this.posY=0,this.lastX=0,this.lastY=0}this.dragging=!1,this.dragged=!1})}resetDrag(){setTimeout(()=>this.soundService.playSound("card-sound"),180),this.undoDrag=!0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.timeout=setTimeout(()=>{this.undoDrag=!1},180)},0)}toFoundation(){const t=this.cards[this.cards.length-1].card,e=Math.floor(t/4),n=t%4;let i=0,s=!0;for(const a of this.foundation){if(1===this.cards.length&&a.length+1===e){const t=a[a.length-1],e=d.get(t,"card",t);if(!e||n===e%4){const t=document.getElementsByClassName(`foundation-${i}`)[0],{left:e,top:n}=this.startElement.getBoundingClientRect(),{left:a,top:o}=t.getBoundingClientRect(),r=e-a,c=n-o,l=this.tableau[this.column].pop();this.tableau[this.column]=[...this.tableau[this.column]],this.foundation[i].push({card:l.card,offsetX:r,offsetY:c,deg:"neat"===this.twentyone.gameSettings.alignment?0:this.card.rand2,scale:1.4}),this.flipCard(),this.solitaire.checkWin(this.foundation),s=!1;break}}i++}s&&this.soundService.playSound("card-sound")}flipCard(){const t=this.tableau[this.column][this.tableau[this.column].length-1];t&&(t.flip=!1)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(C.u),u.Y36(g.t),u.Y36(h.K),u.Y36(k.y))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-card-group"]],viewQuery:function(t,e){if(1&t&&u.Gf($,5),2&t){let t;u.iGM(t=u.CRH())&&(e.card=t.first)}},inputs:{tableau:"tableau",foundation:"foundation",cards:"cards",column:"column",animate:"animate",cardSound:"cardSound",width:"width",offset:"offset"},decls:4,vars:22,consts:[[1,"card-group","d-flex","flex-column",3,"ngClass","ngStyle"],["pos","relative",1,"align-self-center",3,"card","flip","width","animate","cardSound","column","ngClass","ngStyle","mousedown","touchstart"],["card",""],[3,"tableau","foundation","cards","column","width","animate","cardSound",4,"ngIf"],[3,"tableau","foundation","cards","column","width","animate","cardSound"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.TgZ(1,"app-card",1,2),u.NdJ("mousedown",function(t){return e.start(t)})("touchstart",function(t){return e.start(t)}),u.qZA(),u.YNc(3,F,2,9,"app-card-group",3),u.qZA()),2&t&&(u.Q6J("ngClass",u.WLB(12,L,e.dragging,e.undoDrag))("ngStyle",u.WLB(15,W,e.posY+"px",e.posX+"px")),u.uIk("data-column",e.column),u.xp6(1),u.Q6J("card",e.cards[0].card)("flip",e.cards[0].flip)("width",e.width)("animate",e.animate)("cardSound",e.cardSound&&1===e.cards.length)("column",e.column)("ngClass",u.VKq(18,X,!e.cards[0].flip))("ngStyle",u.VKq(20,B,20-e.cards.length)),u.xp6(2),u.Q6J("ngIf",e.cards[1]))},directives:[i.mk,i.PC,O.A,i.O5,t],pipes:[Y.T],styles:[".card-group[_ngcontent-%COMP%]{position:relative}app-card[_ngcontent-%COMP%]{height:3.5vh}app-card.select[_ngcontent-%COMP%]{cursor:pointer}.dragging[_ngcontent-%COMP%]{pointer-events:none;touch-action:none}.undo-drag[_ngcontent-%COMP%]{transition:all .18s ease-in-out}.dragging[_ngcontent-%COMP%], .undo-drag[_ngcontent-%COMP%]{z-index:100;transform:scale(1.1);-moz-filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5));filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5))}"]}),t})();const U=["drawStack"],Q=["cardTalon"];function R(t,e){if(1&t&&u._UZ(0,"app-card",17),2&t){const t=e.$implicit,n=u.oxw().index,i=u.oxw();u.Udp("position","absolute"),u.Q6J("card",t)("cardSound",i.cardSound)("column",n+7)("animate",!1)("pos","relative")}}function D(t,e){if(1&t&&(u.TgZ(0,"div",14),u.TgZ(1,"div"),u._UZ(2,"img",15),u.YNc(3,R,1,7,"app-card",16),u.qZA(),u.qZA()),2&t){const t=e.$implicit,n=e.index;u.xp6(2),u.Gre("foundation-",n,""),u.uIk("data-column",n+7),u.xp6(1),u.Q6J("ngForOf",t)}}function G(t,e){if(1&t&&u._UZ(0,"app-card-group",20),2&t){const t=u.oxw(),e=t.$implicit,n=t.index,i=u.oxw();u.Q6J("tableau",i.tableau)("foundation",i.foundation)("cards",e)("column",n)("animate",i.animate)("cardSound",i.cardSound)}}function N(t,e){if(1&t&&(u.TgZ(0,"div",18),u.TgZ(1,"div"),u._UZ(2,"img",5),u.YNc(3,G,1,6,"app-card-group",19),u.qZA(),u.qZA()),2&t){const t=e.$implicit,n=e.index;u.uIk("data-column",n),u.xp6(2),u.Udp("position",t.length?"absolute":"relative"),u.uIk("data-column",n),u.xp6(1),u.Q6J("ngIf",t.length)}}const E=function(t,e){return{"d-flex":t,"flex-column":e}},z=s.Bz.forChild([{path:"",component:(()=>{class t{constructor(t,e,n,i,s){this.solitaire=t,this.window=e,this.soundService=n,this.cardService=i,this.twentyone=s,this.stock=[],this.talon=[],this.width=120,this.animate=!0,this.cardSound=!1,this.landscape=!1,this.hasStats=!1,this.dealing=!1,this.tableau=[[],[],[],[],[],[],[]],this.foundation=[[],[],[],[]],this.clicked=!1,this.won=!1,this.destroyed$=new r.xQ,this.trackByFn=t=>t,this.subscribeToOrientationResize()}ngOnInit(){return(0,o.mG)(this,void 0,void 0,function*(){this.setWidth(),this.subscribeToGame(),this.subscribeToSave(),this.subscribeToStats(),this.window.focus$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.setWidth())})}subscribeToGame(){this.solitaire.game$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>(0,o.mG)(this,void 0,void 0,function*(){if(t.foundation=t.foundation.map(t=>t.map(t=>t.card||t)),Object.assign(this,t),52===this.stock.length){this.dealing=!0;const t=this.stock.splice(-28,28);this.animate=!0,this.cardSound=!0;for(let e=0;e<7;e++)for(let n=0;n<7;n++)n>=e&&(this.tableau[n].push({card:t.pop(),flip:!0}),this.tableau[n]=[...this.tableau[n]],yield new Promise(t=>setTimeout(t,200)));for(const e of this.tableau)e[e.length-1].flip=!1;yield new Promise(t=>setTimeout(t,150)),this.soundService.playSound("card-sound"),this.animate=!1,this.save()}else this.animate=!1,this.cardSound=!1,setTimeout(()=>this.cardSound=!0,0);yield new Promise(t=>setTimeout(t,100)),this.cardSound=!0,this.dealing=!1}))}subscribeToStats(){this.solitaire.gameStats$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.hasStats=!d.isEmpty(t))}subscribeToOrientationResize(){this.window.orientationresize$.pipe((0,c.R)(this.destroyed$)).subscribe(t=>this.setWidth())}subscribeToSave(){this.solitaire.triggerSave$.pipe((0,c.R)(this.destroyed$)).subscribe(()=>{this.save()})}doEvent(t){switch(t){case"restart":const t=this.foundation.reduce((t,e)=>t+e.length,0);!this.solitaire.game.new&&t<52&&(this.solitaire.gameResult="lose");const e=new l.C;e.stock=this.cardService.shuffleCards(),delete e.new,this.solitaire.game=e;break;case"stats":this.window.loadComponent(x)}}save(){this.solitaire.saveGame({stock:this.stock,tableau:this.tableau,talon:this.talon,foundation:this.foundation.map(t=>t.map(t=>d.get(t,"card",t))),won:this.won})}setWidth(){this.landscape=window.matchMedia("(orientation: landscape)").matches}draw(){return(0,o.mG)(this,void 0,void 0,function*(){if(!this.clicked){this.clicked=!0;for(let t=0;t<(this.twentyone.gameSettings.drawCount||1);t++)if(this.stock.length)this.talon.push(this.stock.pop());else{if(0!==t)break;this.stock=this.talon.reverse(),this.talon=[]}this.save(),(this.stock.length||this.talon.length)&&(yield new Promise(t=>setTimeout(t,100)),this.soundService.playSound("card-sound"),yield new Promise(t=>setTimeout(t,100))),this.clicked=!1}})}ngOnDestroy(){this.solitaire.game={stock:this.stock,tableau:this.tableau,talon:this.talon,foundation:this.foundation.map(t=>t.map(t=>d.get(t,"card",t))),won:this.won},this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(g.t),u.Y36(C.u),u.Y36(k.y),u.Y36(T.J),u.Y36(h.K))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-solitaire"]],viewQuery:function(t,e){if(1&t&&(u.Gf(U,5),u.Gf(Q,5)),2&t){let t;u.iGM(t=u.CRH())&&(e.drawStack=t.first),u.iGM(t=u.CRH())&&(e.cardTalon=t.first)}},decls:19,vars:23,consts:[[1,"solitaire-container","noselect","height-100","position-fixed"],["heading","Solitaire","restart","",3,"hasStats","restartDisabled","action"],[1,"container","height-100"],[1,"row"],[1,"col-stock",3,"ngClass"],["src","/assets/img/card-placeholder.png","alt","Card Placeholder",1,"card-placeholder"],["neat","","pos","relative",1,"stock","select","align-self-center",3,"card","cardSound","animate","cardClick"],["drawStack",""],[1,"col-talon","position-relative"],[3,"cards","tableau","foundation","animate"],["cardTalon",""],[1,"col-space"],["class","col-stock d-flex flex-direction-column col-foundation",4,"ngFor","ngForOf","ngForTrackBy"],["class","col-tableau d-flex flex-column height-100",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-stock","d-flex","flex-direction-column","col-foundation"],["src","/assets/img/card-placeholder.png","alt","Card Placeholder",1,"card-placeholder",2,"position","relative"],[3,"card","cardSound","column","animate","pos","position",4,"ngFor","ngForOf"],[3,"card","cardSound","column","animate","pos"],[1,"col-tableau","d-flex","flex-column","height-100"],[3,"tableau","foundation","cards","column","animate","cardSound",4,"ngIf"],[3,"tableau","foundation","cards","column","animate","cardSound"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.TgZ(1,"app-nav",1),u.NdJ("action",function(t){return e.doEvent(t)}),u.qZA(),u.TgZ(2,"div",2),u.TgZ(3,"div",3),u.TgZ(4,"div"),u.TgZ(5,"div",3),u.TgZ(6,"div",4),u.TgZ(7,"div"),u._UZ(8,"img",5),u.TgZ(9,"app-card",6,7),u.NdJ("cardClick",function(){return e.draw()}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(11,"div",8),u._UZ(12,"app-card-talon",9,10),u.qZA(),u._UZ(14,"div",11),u.YNc(15,D,4,5,"div",12),u.qZA(),u.qZA(),u.TgZ(16,"div"),u.TgZ(17,"div",3),u.YNc(18,N,4,5,"div",13),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&t&&(u.xp6(1),u.Q6J("hasStats",e.hasStats)("restartDisabled",e.dealing),u.xp6(3),u.Tol(e.landscape?"col-sm-2":"col-sm-12"),u.xp6(2),u.Q6J("ngClass",u.WLB(20,E,e.landscape,e.landscape)),u.xp6(3),u.Q6J("card",e.stock.length?"back":0)("cardSound",!1)("animate",!1),u.xp6(3),u.Q6J("cards",e.talon)("tableau",e.tableau)("foundation",e.foundation)("animate",e.animate),u.xp6(3),u.Q6J("ngForOf",e.foundation)("ngForTrackBy",e.trackByFn),u.xp6(1),u.Tol(e.landscape?"col-sm-10":"col-sm-12"),u.xp6(2),u.Q6J("ngForOf",e.tableau)("ngForTrackBy",e.trackByFn))},directives:[_.r,i.mk,O.A,q,i.sg,i.O5,J],styles:[".solitaire-container[_ngcontent-%COMP%]{background:url(/assets/img/felt.jpg);height:100%;width:100%;min-width:320px;min-height:320px;position:fixed;padding:50px 15px 15px;top:0;left:0}.solitaire-container[_ngcontent-%COMP%]     .card{width:100%}.solitaire-container[_ngcontent-%COMP%]     .card-placeholder{width:95%}.solitaire-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:15px 0}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%]   .stock[_ngcontent-%COMP%]{cursor:pointer}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-talon[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-tableau[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-space[_ngcontent-%COMP%]{padding-left:1.5%;padding-right:1.5%;padding-bottom:1.5%;flex:0 0 auto;width:14.2857142857%}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-talon[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-tableau[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-space[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin:0 auto;position:relative}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-tableau[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%]{margin:0 auto;height:unset;top:0;left:0%}.solitaire-container[_ngcontent-%COMP%]   .card-placeholder[_ngcontent-%COMP%]{position:absolute;background:rgba(0,0,0,.15);margin:4px;top:0;left:0}@media (orientation: landscape){.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-talon[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%]{width:50%;position:relative;padding-left:4%;padding-right:4%}.solitaire-container[_ngcontent-%COMP%]   .col-space[_ngcontent-%COMP%]{width:100%;height:20px}}@media only screen and (max-width: 600px){.solitaire-container[_ngcontent-%COMP%]     .card:not(.hide){background-image:url(/assets/img/cards-small.png)!important}}"]}),t})(),data:{view:"solitaire",seo:{title:"Solitaire | Technically Tom",metaTags:[{name:"description",content:"Free card game web app with support for playing off line."},{property:"og:title",content:"Solitaire | Technically Tom | Technically Tom's Solitaire"},{proprety:"og:description",content:"Free card game web app with support for playing off line."},{property:"og:image",content:a.N.appUrl+"assets/img/solitaire.jpg"},{property:"og:image:width",content:"1200"},{property:"og:image:height",content:"630"},{property:"og:url",content:a.N.appUrl+"solitaire"},{name:"twitter:card",content:"website"}]}}}]);var I=n(5059);let H=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[i.ez,I.m,z]]}),t})()}}]);