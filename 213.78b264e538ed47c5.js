"use strict";(self.webpackChunktwenty_one=self.webpackChunktwenty_one||[]).push([[213],{1213:(mt,x,c)=>{c.r(x),c.d(x,{SolitaireModule:()=>ht});var g=c(6895),F=c(3007),Y=c(2340),_=c(5861),y=c(8929),v=c(7625),A=c(4394),h=c(7489),t=c(4650),S=c(7812),T=c(9195),L=c(1377),$=c(1306);function W(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&o){const e=r.$implicit,n=t.oxw().$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.value(n))}}const X=function(o,r){return{"col-lg-6":o,"col-xl-4":r}};function B(o,r){if(1&o&&(t.TgZ(0,"div",18),t.ALo(1,"keyvalue"),t.ALo(2,"keyvalue"),t.TgZ(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"table",19)(6,"tbody"),t.YNc(7,W,5,2,"tr",20),t.qZA()(),t.TgZ(8,"label"),t._uU(9,"Wins vs Losses"),t.qZA(),t.TgZ(10,"div",21)(11,"div",22),t.ALo(12,"percent"),t._uU(13),t.ALo(14,"percent"),t.qZA(),t.TgZ(15,"div",23),t.ALo(16,"percent"),t._uU(17),t.ALo(18,"percent"),t.qZA()(),t.TgZ(19,"label"),t._uU(20,"Wins : Best Winning Streak"),t.qZA(),t.TgZ(21,"div",21)(22,"div",24),t.ALo(23,"appPercentBar"),t.ALo(24,"percent"),t._uU(25),t.qZA()(),t.TgZ(26,"label"),t._uU(27,"Losses : Worst Losing Streak"),t.qZA(),t.TgZ(28,"div",21)(29,"div",24),t.ALo(30,"appPercentBar"),t.ALo(31,"percent"),t._uU(32),t.qZA()()()),2&o){const e=r.$implicit,n=t.oxw();t.Q6J("ngClass",t.WLB(44,X,!(null!=n.settings&&n.settings.sidebar)&&t.lcZ(1,24,n.stats).length>1,!(null!=n.settings&&n.settings.sidebar)&&t.lcZ(2,26,n.stats).length>2)),t.xp6(4),t.Oqu(e.key),t.xp6(3),t.Q6J("ngForOf",n.rows)("ngForTrackBy",n.trackByFn),t.xp6(4),t.Udp("width",e.value.totalWins+e.value.totalLosses===0?0:t.lcZ(12,28,e.value.totalWins/(e.value.totalWins+e.value.totalLosses))),t.xp6(2),t.hij(" Won: ",t.lcZ(14,30,e.value.totalWins/(e.value.totalWins+e.value.totalLosses))," "),t.xp6(2),t.Udp("width",e.value.totalWins+e.value.totalLosses===0?0:t.lcZ(16,32,e.value.totalLosses/(e.value.totalWins+e.value.totalLosses))),t.xp6(2),t.hij(" Lost: ",t.lcZ(18,34,e.value.totalLosses/(e.value.totalWins+e.value.totalLosses))," "),t.xp6(5),t.Gre("progress-bar ",0===e.value.maxWins?"bg-danger":t.lcZ(23,36,e.value.wins/e.value.maxWins),""),t.Udp("width",0===e.value.maxWins?0:t.lcZ(24,38,e.value.wins/e.value.maxWins)),t.xp6(3),t.AsE(" ",e.value.wins," : ",e.value.maxWins," "),t.xp6(4),t.Gre("progress-bar ",0===e.value.maxLose?"bg-success":t.lcZ(30,40,1-e.value.losses/e.value.maxLose),""),t.Udp("width",0===e.value.maxLose?0:t.lcZ(31,42,e.value.losses/e.value.maxLose)),t.xp6(3),t.AsE(" ",e.value.losses," : ",e.value.maxLose," ")}}const J=function(o,r){return{show:o,sidebar:r}},U=function(o,r){return{"modal-xl":o,"modal-lg":r}},Q=function(o){return{show:o}};let R=(()=>{class o{constructor(e,n,i){this.solitaire=e,this.twentyone=n,this.appRef=i,this.rows=[{name:"Total Hands Played",value:a=>`${a.value.gamesPlayed}`},{name:"Winning Streak",value:a=>`${a.value.wins||""}`},{name:"Best Winning Streak",value:a=>`${a.value.maxWins||""}`},{name:"Losiing Streak",value:a=>`${a.value.losses||""}`},{name:"Worst Losing Streak",value:a=>`${a.value.maxLose||""}`},{name:"Total Games Won",value:a=>`${a.value.totalWins}`},{name:"Total Games Lost",value:a=>`${a.value.totalLosses}`}],this.destroyed$=new y.xQ,this.trackByFn=a=>a,this.solitaire.gameStats$.pipe((0,v.R)(this.destroyed$)).subscribe(a=>this.stats=a),this.twentyone.settings$.pipe((0,v.R)(this.destroyed$)).subscribe(a=>this.settings=a)}ngOnInit(){setTimeout(()=>this.show=!0,0)}close(){this.show=!1,setTimeout(()=>{this.appRef.detachView(this.componentRef.hostView),this.componentRef.destroy()},180)}setSidebar(){this.settings.sidebar=!this.settings.sidebar,this.twentyone.saveSettings(this.settings)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(S.t),t.Y36(T.K),t.Y36(t.z2F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ng-component"]],inputs:{componentRef:"componentRef"},decls:26,vars:23,consts:[[1,"modal","fade",3,"ngClass","click"],[3,"ngClass","click"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["href","#",1,"tab-loop",3,"focus"],["mdAutoFocus","","type","button",1,"btn-resize",3,"click"],["first",""],["height","25px","alt","Window Resize",3,"src"],["type","button","aria-label","Close",1,"button-close",3,"click"],["src","/assets/img/close.svg","height","25px","alt","Window Resize"],[1,"modal-body"],[1,"row","d-flex","justify-content-center"],["class","col-sm-12",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"modal-footer"],["type","button","mat-stroked-button","","color","primary",3,"click"],["last",""],[1,"modal-backdrop","fade",3,"ngClass"],[1,"col-sm-12",3,"ngClass"],[1,"table","table-sm","w-100"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"progress"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-danger"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100"]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",0),t.NdJ("click",function(){return n.close()}),t.TgZ(1,"div",1),t.NdJ("click",function(s){return s.stopPropagation()}),t.ALo(2,"keyvalue"),t.ALo(3,"keyvalue"),t.TgZ(4,"div",2)(5,"div",3)(6,"h5",4),t._uU(7,"Solitaire Stats"),t.qZA(),t.TgZ(8,"a",5),t.NdJ("focus",function(){t.CHM(i);const s=t.MAs(21);return t.KtG(s.focus())}),t._uU(9,"to last"),t.qZA(),t.TgZ(10,"button",6,7),t.NdJ("click",function(){return n.setSidebar()}),t._UZ(12,"img",8),t.qZA(),t.TgZ(13,"button",9),t.NdJ("click",function(){return n.close()}),t._UZ(14,"img",10),t.qZA()(),t.TgZ(15,"div",11)(16,"div",12),t.YNc(17,B,33,47,"div",13),t.ALo(18,"keyvalue"),t.qZA()(),t.TgZ(19,"div",14)(20,"button",15,16),t.NdJ("click",function(){return n.close()}),t._uU(22," Close "),t.qZA(),t.TgZ(23,"a",5),t.NdJ("focus",function(){t.CHM(i);const s=t.MAs(11);return t.KtG(s.focus())}),t._uU(24,"to last"),t.qZA()()()()(),t._UZ(25,"div",17)}2&e&&(t.Q6J("ngClass",t.WLB(15,J,n.show,n.settings.sidebar)),t.xp6(1),t.Gre("modal-dialog modal-dialog-centered modal-dialog-scrollable",n.settings.sidebar?"":" modal-xl",""),t.Q6J("ngClass",t.WLB(18,U,!n.settings.sidebar&&t.lcZ(2,9,n.stats).length>2,!n.settings.sidebar&&t.lcZ(3,11,n.stats).length>1)),t.xp6(11),t.MGl("src","/assets/img/",null!=n.settings&&n.settings.sidebar?"dice-1.svg":"arrow-right-square.svg","",t.LSH),t.xp6(5),t.Q6J("ngForOf",t.lcZ(18,13,n.stats))("ngForTrackBy",n.trackByFn),t.xp6(8),t.Q6J("ngClass",t.VKq(21,Q,n.show)))},dependencies:[g.mk,g.sg,L.lW,g.Zx,g.Nd,$.g],styles:["h2[_ngcontent-%COMP%]{margin:0}label[_ngcontent-%COMP%]{font-weight:600}.progress[_ngcontent-%COMP%]{margin-bottom:12px}"]}),o})();var w=c(9004),k=c(4252),G=c(3671),O=c(3949),D=c(166);const N=["card"];function E(o,r){if(1&o&&(t._UZ(0,"app-card-group",4),t.ALo(1,"cardGroup")),2&o){const e=t.oxw();t.Q6J("tableau",e.tableau)("foundation",e.foundation)("cards",t.lcZ(1,6,e.cards))("column",e.column)("animate",e.animate)("cardSound",e.cardSound)}}const q=function(o,r){return{dragging:o,"undo-drag":r}},z=function(o,r){return{top:o,left:r}},V=function(o){return{select:o}},I=function(o){return{"z-index":o}};let j=(()=>{class o{constructor(e,n,i,a){this.window=e,this.solitaire=n,this.twentyone=i,this.soundService=a,this.dragging=!1,this.dragged=!1,this.lastX=0,this.lastY=0,this.posX=0,this.posY=0,this.undoDrag=!1,this.tableau=[],this.foundation=[],this.cards=[],this.destroyed$=new y.xQ,this.window.mousetouchmove$.pipe((0,v.R)(this.destroyed$)).subscribe(s=>this.doDrag(s)),this.window.mousetouchend$.pipe((0,v.R)(this.destroyed$)).subscribe(s=>this.endDrag(s))}start(e){e.preventDefault(),this.cards[0].flip||(this.startElement=e.target,this.dragging=!0,document.body.classList.add("dragging"),this.soundService.playSound("card-sound"))}doDrag(e){if(this.dragging){const n=e.clientX||h.get(e,"touches[0].clientX"),i=e.clientY||h.get(e,"touches[0].clientY"),a=void 0!==e.clientX||!e.touches[1];(Math.abs(this.posX)>10||Math.abs(this.posY)>10)&&(this.dragged=!0),clearTimeout(this.timeout),a&&this.lastX&&!this.cards[0].flip&&(this.posX+=n-this.lastX,this.posY+=i-this.lastY),this.lastX=n,this.lastY=i}}endDrag(e){var n=this;return(0,_.Z)(function*(){document.body.classList.remove("dragging");let i,a=!0;const s=h.get(e,"changedTouches[0]");if(s?i=document.elementFromPoint(s.clientX,s.clientY):s||(i=document.elementFromPoint(e.clientX,e.clientY)),n.posX=0,n.posY=0,n.lastX=0,n.lastY=0,n.dragging&&i){if(n.dragged){let l=null;if(i&&(l=i.getAttribute("data-column")),null!==l){l=+l;const u=n.cards[0].card,m=Math.floor(u/4),p=u%4;if(l>6){if(1===n.cards.length&&n.foundation[l-7].length+1===m){const d=n.foundation[l-7][n.foundation[l-7].length-1];if(!d||p===h.get(d,"card",d)%4){const f=n.tableau[n.column].pop();n.tableau[n.column]=[...n.tableau[n.column]],n.foundation[l-7].push(f.card),n.flipCard(),n.solitaire.checkWin(),a=!1}}}else{const d=n.tableau[l][n.tableau[l].length-1];let f=0,C=0;if(d&&(f=Math.floor(d.card/4),C=d.card%4),m===f-1&&p%2!=C%2||0===f&&13===m){const b=n.tableau[n.column].splice(-n.cards.length);n.tableau[n.column]=[...n.tableau[n.column]],n.tableau[l].push(...b),n.tableau[l]=[...n.tableau[l]],n.flipCard(),n.solitaire.checkWin(),a=!1}}}a&&n.resetDrag()}else n.toFoundation();n.posX=0,n.posY=0,n.lastX=0,n.lastY=0}n.dragging=!1,n.dragged=!1})()}resetDrag(){setTimeout(()=>this.soundService.playSound("card-sound"),180),this.undoDrag=!0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.timeout=setTimeout(()=>{this.undoDrag=!1},180)},0)}toFoundation(){const e=this.cards[this.cards.length-1].card,n=Math.floor(e/4),i=e%4;let a=0,s=!0;for(const l of this.foundation){if(1===this.cards.length&&l.length+1===n){const u=l[l.length-1],m=h.get(u,"card",u);if(!m||i===m%4){const p=document.getElementsByClassName(`foundation-${a}`)[0],{left:d,top:f}=this.startElement.getBoundingClientRect(),{left:C,top:b}=p.getBoundingClientRect(),M=d-C,Z=f-b,P=this.tableau[this.column].pop();this.tableau[this.column]=[...this.tableau[this.column]],this.foundation[a].push({card:P.card,offsetX:M,offsetY:Z,deg:"neat"===this.twentyone.gameSettings.alignment?0:this.card.rand2,scale:1.4}),this.flipCard(),this.solitaire.checkWin(),s=!1;break}}a++}s&&this.soundService.playSound("card-sound")}flipCard(){const e=this.tableau[this.column][this.tableau[this.column].length-1];e&&(e.flip=!1)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w.u),t.Y36(S.t),t.Y36(T.K),t.Y36(k.y))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-card-group"]],viewQuery:function(e,n){if(1&e&&t.Gf(N,5),2&e){let i;t.iGM(i=t.CRH())&&(n.card=i.first)}},inputs:{tableau:"tableau",foundation:"foundation",cards:"cards",column:"column",animate:"animate",cardSound:"cardSound"},decls:4,vars:21,consts:[[1,"card-group","d-flex","flex-column",3,"ngClass","ngStyle"],["pos","relative",1,"align-self-center",3,"card","flip","animate","cardSound","column","ngClass","ngStyle","mousedown","touchstart"],["card",""],[3,"tableau","foundation","cards","column","animate","cardSound",4,"ngIf"],[3,"tableau","foundation","cards","column","animate","cardSound"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-card",1,2),t.NdJ("mousedown",function(a){return n.start(a)})("touchstart",function(a){return n.start(a)}),t.qZA(),t.YNc(3,E,2,8,"app-card-group",3),t.qZA()),2&e&&(t.Q6J("ngClass",t.WLB(11,q,n.dragging,n.undoDrag))("ngStyle",t.WLB(14,z,n.posY+"px",n.posX+"px")),t.uIk("data-column",n.column),t.xp6(1),t.Q6J("card",n.cards[0].card)("flip",n.cards[0].flip)("animate",n.animate)("cardSound",n.cardSound&&1===n.cards.length)("column",n.column)("ngClass",t.VKq(17,V,!n.cards[0].flip))("ngStyle",t.VKq(19,I,20-n.cards.length)),t.xp6(2),t.Q6J("ngIf",n.cards[1]))},dependencies:[g.mk,g.O5,g.PC,O.A,o,D.T],styles:[".card-group[_ngcontent-%COMP%]{position:relative}app-card[_ngcontent-%COMP%]{height:3.5vh}app-card.select[_ngcontent-%COMP%]{cursor:pointer}.dragging[_ngcontent-%COMP%]{pointer-events:none;touch-action:none}.undo-drag[_ngcontent-%COMP%]{transition:all .18s ease-in-out}.dragging[_ngcontent-%COMP%], .undo-drag[_ngcontent-%COMP%]{z-index:100;transform:scale(1.1);-moz-filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5));filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5))}"]}),o})();const H=["cardElement"];function K(o,r){1&o&&t._UZ(0,"app-card",6),2&o&&t.Q6J("card",r.$implicit||0)("animate",!1)}const tt=function(o,r){return{"undo-drag":o,dragging:r}},et=function(o,r){return{top:o,left:r}};let nt=(()=>{class o{constructor(e,n,i){this.window=e,this.solitaire=n,this.soundService=i,this.dragging=!1,this.dragged=!1,this.lastX=0,this.lastY=0,this.posX=0,this.posY=0,this.undoDrag=!1,this.tableau=[],this.foundation=[],this.cards=[],this.destroyed$=new y.xQ,this.trackByFn=(a,s)=>s,this.window.mousetouchmove$.pipe((0,v.R)(this.destroyed$)).subscribe(a=>this.doDrag(a)),this.window.mousetouchend$.pipe((0,v.R)(this.destroyed$)).subscribe(a=>this.endDrag(a))}start(e){e.preventDefault(),this.startElement=e.target,this.cards.length&&(document.body.classList.add("dragging"),this.dragging=!0,this.soundService.playSound("card-sound"))}doDrag(e){e.preventDefault();const n=e.clientX||h.get(e,"touches[0].clientX"),i=e.clientY||h.get(e,"touches[0].clientY"),a=void 0!==e.clientX||!e.touches[1];(Math.abs(this.posX)>10||Math.abs(this.posY)>10)&&(this.dragged=!0),this.dragging&&a&&(this.lastX&&(this.posX+=n-this.lastX,this.posY+=i-this.lastY),this.lastX=n,this.lastY=i)}endDrag(e){document.body.classList.remove("dragging");let n,i=!0;const a=h.get(e,"changedTouches[0]");if(n=a?document.elementFromPoint(a.clientX,a.clientY):document.elementFromPoint(e.x,e.y),this.dragging)if(this.dragged){let s;if(n&&(s=n.getAttribute("data-column")),s){const l=this.cards[this.cards.length-1],u=Math.floor(l/4),m=l%4;if(+s>6){if(this.foundation[+s-7].length+1===u){const p=this.foundation[+s-7][this.foundation[+s-7].length-1];if(!p||m===h.get(p,"card",p)%4){const d=this.cards.pop();this.foundation[+s-7].push(d),i=!1}}this.dragging=!1,this.dragged=!1,this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.solitaire.checkWin()}else{const p=this.tableau[s][this.tableau[s].length-1];let d=0,f=0;if(p&&(d=Math.floor(p.card/4),f=p.card%4),u===d-1&&m%2!=f%2||0===d&&13===u){const C=this.cards.pop();this.tableau[s].push({card:C,flip:!1}),this.tableau[s]=[...this.tableau[s]],this.solitaire.checkWin(),i=!1}}}i&&this.resetDrag()}else this.toFoundation();this.dragging=!1,this.dragged=!1,this.posX=0,this.posY=0,this.lastX=0,this.lastY=0}resetDrag(){setTimeout(()=>this.soundService.playSound("card-sound"),180),this.undoDrag=!0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.posX=0,this.posY=0,this.lastX=0,this.lastY=0,this.timeout=setTimeout(()=>this.undoDrag=!1,180)},0)}toFoundation(){var e=this;return(0,_.Z)(function*(){const n=e.cards[e.cards.length-1],i=Math.floor(n/4),a=n%4;let s=0,l=!0;for(const u of e.foundation){if(u.length+1===i){const m=u[u.length-1];if(!m||a===h.get(m,"card",m)%4){const p=document.getElementsByClassName(`foundation-${s}`)[0],{left:d,top:f}=e.startElement.getBoundingClientRect(),{left:C,top:b}=p.getBoundingClientRect(),M=d-C,Z=f-b,P=e.cards.pop();e.foundation[s].push({card:P,offsetX:M,offsetY:Z,deg:0,scale:1.1}),l=!1,e.solitaire.checkWin();break}}s++}l&&e.soundService.playSound("card-sound")})()}get nativeElement(){return this.cardElement.nativeElement}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w.u),t.Y36(S.t),t.Y36(k.y))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-card-talon"]],viewQuery:function(e,n){if(1&e&&t.Gf(H,5),2&e){let i;t.iGM(i=t.CRH())&&(n.cardElement=i.first)}},inputs:{tableau:"tableau",foundation:"foundation",cards:"cards",column:"column",animate:"animate"},decls:6,vars:12,consts:[[1,"text-center","position-relative"],["src","/assets/img/card-placeholder.png","alt","Card Placeholder","pos","relative",1,"card-placeholder"],["pos","absolute","class","card-stack",3,"card","animate",4,"ngFor","ngForOf","ngForTrackBy"],[1,"card-group","block","text-center","position-absolute","w-100",3,"ngClass","ngStyle"],["pos","relative",3,"card","animate","mousedown","touchstart"],["cardElement",""],["pos","absolute",1,"card-stack",3,"card","animate"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"img",1),t.YNc(2,K,1,2,"app-card",2),t.TgZ(3,"div",3)(4,"app-card",4,5),t.NdJ("mousedown",function(a){return n.start(a)})("touchstart",function(a){return n.start(a)}),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.cards.slice(0,-1))("ngForTrackBy",n.trackByFn),t.xp6(1),t.Q6J("ngClass",t.WLB(6,tt,n.undoDrag,n.dragging))("ngStyle",t.WLB(9,et,n.posY+"px",n.posX+"px")),t.xp6(1),t.Q6J("card",n.cards[n.cards.length-1]||0)("animate",n.animate))},dependencies:[g.mk,g.sg,g.PC,O.A],styles:[".card-group[_ngcontent-%COMP%]{position:relative}.card-group[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%]{margin:0 auto;display:inline-block}.card-placeholder[_ngcontent-%COMP%]{background:rgba(0,0,0,.15);margin:4px auto}.dragging[_ngcontent-%COMP%]{pointer-events:none;touch-action:none}.undo-drag[_ngcontent-%COMP%]{transition:all .18s ease-in-out}.dragging[_ngcontent-%COMP%], .undo-drag[_ngcontent-%COMP%]{z-index:100;transform:scale(1.1);-moz-filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5));filter:drop-shadow(-2px -2px 8px rgba(0,0,0,.5))}.card-stack[_ngcontent-%COMP%]{position:absolute;width:100%;top:0;left:0}"]}),o})();var ot=c(7284);const at=["drawStack"],it=["cardTalon"];function st(o,r){if(1&o&&t._UZ(0,"app-card",17),2&o){const e=r.$implicit,n=t.oxw().index,i=t.oxw();t.Udp("position","absolute"),t.Q6J("card",e)("cardSound",i.cardSound)("column",n+7)("animate",!1)("pos","relative")}}function rt(o,r){if(1&o&&(t.TgZ(0,"div",14)(1,"div"),t._UZ(2,"img",15),t.YNc(3,st,1,7,"app-card",16),t.qZA()()),2&o){const e=r.$implicit,n=r.index;t.xp6(2),t.Gre("foundation-",n,""),t.uIk("data-column",n+7),t.xp6(1),t.Q6J("ngForOf",e)}}function lt(o,r){if(1&o&&t._UZ(0,"app-card-group",20),2&o){const e=t.oxw(),n=e.$implicit,i=e.index,a=t.oxw();t.Q6J("tableau",a.tableau)("foundation",a.foundation)("cards",n)("column",i)("animate",a.animate)("cardSound",a.cardSound)}}function ct(o,r){if(1&o&&(t.TgZ(0,"div",18)(1,"div"),t._UZ(2,"img",5),t.YNc(3,lt,1,6,"app-card-group",19),t.qZA()()),2&o){const e=r.$implicit,n=r.index;t.uIk("data-column",n),t.xp6(2),t.Udp("position",e.length?"absolute":"relative"),t.uIk("data-column",n),t.xp6(1),t.Q6J("ngIf",e.length)}}const dt=function(o,r){return{"d-flex":o,"flex-column":r}},gt=F.Bz.forChild([{path:"",component:(()=>{class o{constructor(e,n,i,a,s){this.solitaire=e,this.window=n,this.soundService=i,this.cardService=a,this.twentyone=s,this.stock=[],this.talon=[],this.animate=!0,this.cardSound=!1,this.landscape=!1,this.hasStats=!1,this.dealing=!1,this.tableau=[[],[],[],[],[],[],[]],this.foundation=[[],[],[],[]],this.clicked=!1,this.won=!1,this.destroyed$=new y.xQ,this.trackByFn=l=>l,this.subscribeToOrientationResize()}ngOnInit(){var e=this;return(0,_.Z)(function*(){e.setWidth(),e.subscribeToGame(),e.subscribeToSave(),e.subscribeToStats(),e.window.focus$.pipe((0,v.R)(e.destroyed$)).subscribe(n=>e.setWidth())})()}subscribeToGame(){var e=this;this.solitaire.game$.pipe((0,v.R)(this.destroyed$)).subscribe(function(){var n=(0,_.Z)(function*(i){if(i.foundation=i.foundation.map(a=>a.map(s=>s.card||s)),Object.assign(e,i),52===e.stock.length){e.dealing=!0;const a=e.stock.splice(-28,28);e.animate=!0,e.cardSound=!0;for(let s=0;s<7;s++)for(let l=0;l<7;l++)l>=s&&(e.tableau[l].push({card:a.pop(),flip:!0}),e.tableau[l]=[...e.tableau[l]],yield new Promise(u=>setTimeout(u,200)));for(const s of e.tableau)s[s.length-1].flip=!1;yield new Promise(s=>setTimeout(s,150)),e.soundService.playSound("card-sound"),e.animate=!1,e.save()}else e.animate=!1,e.cardSound=!1,setTimeout(()=>e.cardSound=!0,0);yield new Promise(a=>setTimeout(a,100)),e.cardSound=!0,e.dealing=!1});return function(i){return n.apply(this,arguments)}}())}subscribeToStats(){this.solitaire.gameStats$.pipe((0,v.R)(this.destroyed$)).subscribe(e=>this.hasStats=!h.isEmpty(e))}subscribeToOrientationResize(){this.window.orientationresize$.pipe((0,v.R)(this.destroyed$)).subscribe(e=>this.setWidth())}subscribeToSave(){this.solitaire.triggerSave$.pipe((0,v.R)(this.destroyed$)).subscribe(()=>{this.save()})}doEvent(e){switch(e){case"restart":const n=this.foundation.reduce((a,s)=>a+s.length,0);!this.solitaire.game.new&&n<52&&(this.solitaire.gameResult="lose");const i=new A.C;i.stock=this.cardService.shuffleCards(),delete i.new,this.solitaire.game=i;break;case"stats":this.window.loadComponent(R)}}save(){this.solitaire.saveGame({stock:this.stock,tableau:this.tableau,talon:this.talon,foundation:this.foundation.map(e=>e.map(n=>h.get(n,"card",n))),won:this.won})}setWidth(){this.landscape=window.matchMedia("(orientation: landscape)").matches}draw(){var e=this;return(0,_.Z)(function*(){if(!e.clicked){e.clicked=!0;for(let n=0;n<(e.twentyone.gameSettings.drawCount||1);n++)if(e.stock.length)e.talon.push(e.stock.pop());else{if(0!==n)break;e.stock=e.talon.reverse(),e.talon=[]}e.save(),(e.stock.length||e.talon.length)&&(yield new Promise(n=>setTimeout(n,100)),e.soundService.playSound("card-sound"),yield new Promise(n=>setTimeout(n,100))),e.clicked=!1}})()}ngOnDestroy(){this.solitaire.game={stock:this.stock,tableau:this.tableau,talon:this.talon,foundation:this.foundation.map(e=>e.map(n=>h.get(n,"card",n))),won:this.won},this.destroyed$.next(),this.destroyed$.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(S.t),t.Y36(w.u),t.Y36(k.y),t.Y36(G.J),t.Y36(T.K))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-solitaire"]],viewQuery:function(e,n){if(1&e&&(t.Gf(at,5),t.Gf(it,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.drawStack=i.first),t.iGM(i=t.CRH())&&(n.cardTalon=i.first)}},decls:19,vars:23,consts:[[1,"solitaire-container","noselect","height-100","position-fixed"],["heading","Solitaire","restart","",3,"hasStats","restartDisabled","action"],[1,"container","height-100"],[1,"row"],[1,"col-stock",3,"ngClass"],["src","/assets/img/card-placeholder.png","alt","Card Placeholder",1,"card-placeholder"],["neat","","pos","relative",1,"stock","select","align-self-center",3,"card","cardSound","animate","cardClick"],["drawStack",""],[1,"col-talon","position-relative"],[3,"cards","tableau","foundation","animate"],["cardTalon",""],[1,"col-space"],["class","col-stock d-flex flex-direction-column col-foundation",4,"ngFor","ngForOf","ngForTrackBy"],["class","col-tableau d-flex flex-column height-100",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-stock","d-flex","flex-direction-column","col-foundation"],["src","/assets/img/card-placeholder.png","alt","Card Placeholder",1,"card-placeholder",2,"position","relative"],[3,"card","cardSound","column","animate","pos","position",4,"ngFor","ngForOf"],[3,"card","cardSound","column","animate","pos"],[1,"col-tableau","d-flex","flex-column","height-100"],[3,"tableau","foundation","cards","column","animate","cardSound",4,"ngIf"],[3,"tableau","foundation","cards","column","animate","cardSound"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-nav",1),t.NdJ("action",function(a){return n.doEvent(a)}),t.qZA(),t.TgZ(2,"div",2)(3,"div",3)(4,"div")(5,"div",3)(6,"div",4)(7,"div"),t._UZ(8,"img",5),t.TgZ(9,"app-card",6,7),t.NdJ("cardClick",function(){return n.draw()}),t.qZA()()(),t.TgZ(11,"div",8),t._UZ(12,"app-card-talon",9,10),t.qZA(),t._UZ(14,"div",11),t.YNc(15,rt,4,5,"div",12),t.qZA()(),t.TgZ(16,"div")(17,"div",3),t.YNc(18,ct,4,5,"div",13),t.qZA()()()()()),2&e&&(t.xp6(1),t.Q6J("hasStats",n.hasStats)("restartDisabled",n.dealing),t.xp6(3),t.Tol(n.landscape?"col-sm-2":"col-sm-12"),t.xp6(2),t.Q6J("ngClass",t.WLB(20,dt,n.landscape,n.landscape)),t.xp6(3),t.Q6J("card",n.stock.length?"back":0)("cardSound",!1)("animate",!1),t.xp6(3),t.Q6J("cards",n.talon)("tableau",n.tableau)("foundation",n.foundation)("animate",n.animate),t.xp6(3),t.Q6J("ngForOf",n.foundation)("ngForTrackBy",n.trackByFn),t.xp6(1),t.Tol(n.landscape?"col-sm-10":"col-sm-12"),t.xp6(2),t.Q6J("ngForOf",n.tableau)("ngForTrackBy",n.trackByFn))},dependencies:[g.mk,g.sg,g.O5,O.A,j,nt,ot.r],styles:[".solitaire-container[_ngcontent-%COMP%]{background:url(/assets/img/felt.jpg);height:100%;width:100%;min-width:320px;min-height:320px;position:fixed;padding:50px 15px 15px;top:0;left:0}.solitaire-container[_ngcontent-%COMP%]     .card{width:100%}.solitaire-container[_ngcontent-%COMP%]     .card-placeholder{width:95%}.solitaire-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:15px 0}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%]   .stock[_ngcontent-%COMP%]{cursor:pointer}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-talon[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-tableau[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-space[_ngcontent-%COMP%]{padding-left:1.5%;padding-right:1.5%;padding-bottom:1.5%;flex:0 0 auto;width:14.2857142857%}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-talon[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-tableau[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-space[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin:0 auto;position:relative}.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-tableau[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%]{margin:0 auto;height:auto;height:initial;top:0;left:0%}.solitaire-container[_ngcontent-%COMP%]   .card-placeholder[_ngcontent-%COMP%]{position:absolute;background:rgba(0,0,0,.15);margin:4px;top:0;left:0}@media (orientation: landscape){.solitaire-container[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-talon[_ngcontent-%COMP%], .solitaire-container[_ngcontent-%COMP%]   .col-foundation[_ngcontent-%COMP%]{width:50%;position:relative;padding-left:4%;padding-right:4%}.solitaire-container[_ngcontent-%COMP%]   .col-space[_ngcontent-%COMP%]{width:100%;height:20px}}@media only screen and (max-width: 600px){.solitaire-container[_ngcontent-%COMP%]     .card:not(.hide){background-image:url(/assets/img/cards-small.png)!important}}"]}),o})(),data:{view:"solitaire",seo:{title:"Solitaire | Technically Tom",metaTags:[{name:"description",content:"Free card game web app with support for playing off line."},{property:"og:title",content:"Solitaire | Technically Tom | Technically Tom's Solitaire"},{proprety:"og:description",content:"Free card game web app with support for playing off line."},{property:"og:image",content:Y.N.appUrl+"assets/img/solitaire.jpg"},{property:"og:image:width",content:"1200"},{property:"og:image:height",content:"630"},{property:"og:url",content:Y.N.appUrl+"solitaire"},{name:"twitter:card",content:"website"}]}}}]);var pt=c(1620);let ht=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,pt.m,gt]}),o})()}}]);